<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>마이페이지 탈퇴</title>
    <link rel="stylesheet" href="../css/deleteUser.css"></link>
    <link rel="stylesheet" href="../css/header.css"></link>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  </head>

  <body>
    <%- include ('./header02.ejs') %>
    <!-- 네비바 -->
    <nav>
        <div class="myProfileNav">
          <div class="myPage">마이페이지</div>
          <h1></h1>
          <ul class="list">
            <li>
              <a href="/ordercheck" class="order">주문 내역</a>
            </li>
            <li>
              <a href="/myProfile" class="myInfo">개인 정보 수정</a>
            </li>
            <li>
              <a href="/cart" class="cart">장바구니</a>
            </li>
          </ul>
        </div>
    </nav>

    <!--개인정보탈퇴 폼-->
    <form class="deleteUserForm">
        <div class="container">
          <div class="block account-header">
            <h1 class="subtitle is-4" id="securityTitle">회원 탈퇴</h1>
            <h6></h6>
          </div>
          <div class="menu-container">
            <div class="form-container">
                <div class="field">
                  <h5 class="subtitle">회원 탈퇴(이용약관 동의 철회) 시 아래 내용을 확인해주세요.</h5>
                </div>
                <div class="box-container">
                    <li>이용약관 동의를 철회한 후에라도 해당 약관에 다시 동의하시면 서비스를 이용할 수 있습니다.</li>
                    <li>진행 중인 전자상거래 이용내역(결제/배송/교환/반품 중인 상태)이 있거나 고객상담 및 이용하신 서비스가 완료되지 않은 경우 서비스 철회 하실 수 없습니다.</li>
                    <li>회원 탈퇴시 계정과 마이페이지의 모든 정보와 DB가 자동 삭제되며, 1년 내 재가입/회원구매에 제약이 있습니다.</li>
                    <li>또한 재가입 이후에도 일정 기간 이벤트 참여 등 제한되니, 신중히 결정해주세요.</>
                </div>
                <div class="field">
                    <h5 class="confirm">회원 탈퇴(이용약관 동의 철회)를 하시겠습니까?</h5>
                </div>
                <h6></h6>
                <button type="button" onclick="location.href='/myProfile'" class="cancel-btn" id="cancelButton">취소</button>
                <button type="submit" class="delete-btn" id="deleteButton">탈퇴</button>
            </div>
          </div>
    </form>

    <script>
        const form = document.querySelector(".deleteUserForm");
        form.addEventListener("submit", handleDelete);
        function handleDelete(e) {
          e.preventDefault();
          if (confirm("회원 탈퇴(이용약관 동의 철회)를 하시겠습니까?")) {
            axios
              .delete("/api/user/delete")
              .then((response) => {
                console.log(response);
                // alert(response.data.msg);
                // if (response.status === 200) {
                //   window.location.href = "/";
                // }
              })
            //   .catch((error) => {
            //     console.error(error);
            //     alert("회원 탈퇴에 실패했습니다. 다시 시도해주세요.");
            //   });
          }
        console.log("hehe");
    }
      </script>
  </body>
</html>
